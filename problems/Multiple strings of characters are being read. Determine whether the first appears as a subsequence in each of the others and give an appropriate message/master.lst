     1                                  bits 32
     2                                  global start        
     3                                  
     4                                  extern exit, printf, scanf
     5                                  import exit msvcrt.dll
     6                                  import printf msvcrt.dll
     7                                  import scanf msvcrt.dll
     8                                  %include "slave.asm"
     1                              <1> %ifndef _SLAVE_ASM_
     2                              <1> %define _SLAVE_ASM_
     3                              <1> 
     4                              <1> extern exit
     5                              <1> import exit msvcrt.dll
     6                              <1> 
     7                              <1>     templateFun:
     8 00000000 55                  <1>         push ebp
     9 00000001 89E5                <1>         mov ebp, esp
    10                              <1>         
    11 00000003 C9                  <1>         leave
    12 00000004 C3                  <1>         ret
    13                              <1>     
    14                              <1>     isLeaveCommand:
    15 00000005 55                  <1>         push ebp
    16 00000006 89E5                <1>         mov ebp, esp
    17 00000008 B800000000          <1>         mov eax, 0
    18 0000000D 8B542408            <1>         mov edx, [esp + 8]
    19 00000011 803A6C              <1>         cmp byte [edx], 'l'
    20 00000014 751D                <1>         jnz .exitfun
    21 00000016 807A0165            <1>         cmp byte [edx + 1], 'e'
    22 0000001A 7517                <1>         jnz .exitfun
    23 0000001C 807A0261            <1>         cmp byte [edx + 2], 'a'
    24 00000020 7511                <1>         jnz .exitfun
    25 00000022 807A0376            <1>         cmp byte [edx + 3], 'v'
    26 00000026 750B                <1>         jnz .exitfun
    27 00000028 807A0465            <1>         cmp byte [edx + 4], 'e'
    28 0000002C 7505                <1>         jnz .exitfun
    29 0000002E B801000000          <1>         mov eax, 1
    30                              <1>         .exitfun:
    31 00000033 C9                  <1>             leave
    32 00000034 C3                  <1>             ret
    33                              <1>     
    34                              <1>     resetBuffer:
    35 00000035 55                  <1>         push ebp
    36 00000036 89E5                <1>         mov ebp, esp
    37                              <1>         
    38 00000038 8B442408            <1>         mov eax, [esp + 8]
    39                              <1>             
    40 0000003C C9                  <1>         leave
    41 0000003D C3                  <1>         ret
    42                              <1>     
    43                              <1>     hasRepeated:
    44 0000003E 55                  <1>         push ebp
    45 0000003F 89E5                <1>         mov ebp, esp
    46                              <1>         
    47                              <1>         
    48 00000041 837C240C00          <1>         cmp dword [esp + 12], 0
    49 00000046 7402                <1>         jz .firstCycle
    50                              <1>         
    51 00000048 EB14                <1>         jmp .exitfun
    52                              <1>         .firstCycle:
    53 0000004A 8B742408            <1>             mov esi, [esp + 8]
    54 0000004E BF[60000000]        <1>             mov edi, firstBuffer
    55                              <1>             .loop1:
    56 00000053 AC                  <1>                 lodsb
    57 00000054 AA                  <1>                 stosb
    58 00000055 3C00                <1>                 cmp al, 0
    59 00000057 75FA                <1>                 jnz .loop1
    60 00000059 B800000000          <1>             mov eax, 0
    61                              <1>             
    62                              <1>         .exitfun:
    63 0000005E C9                  <1>             leave
    64 0000005F C3                  <1>             ret
    65                              <1> %endif
     9                                  
    10                                  ;Multiple strings of characters are being read.
    11                                  ;Determine whether the first appears as a subsequence in each of the others and give an appropriate message.
    12                                  
    13                                  segment data use32 class=data
    14 00000060 <res 00000064>              firstBuffer resb 100
    15 000000C4 <res 00000064>              buffer resb 100
    16 00000128 257300                      scanfmt db '%s', 0
    17 0000012B 257300                      printfmt db '%s', 0
    18                                  segment code use32 class=code
    19                                      start:
    20 00000000 B900000000                      mov ecx, 0
    21                                          .mainloop:
    22 00000005 68[C4000000]                        push buffer
    23 0000000A 68[28010000]                        push scanfmt
    24 0000000F FF15[00000000]                      call [scanf]
    25 00000015 83C408                              add esp, 4 * 2
    26                                              
    27 00000018 68[C4000000]                        push buffer
    28 0000001D E8(05000000)                        call isLeaveCommand
    29 00000022 83C404                              add esp, 4
    30 00000025 83F801                              cmp eax, 1
    31 00000028 7411                                jz exitprogram
    32                                              
    33 0000002A 51                                  push ecx
    34 0000002B 68[C4000000]                        push buffer
    35 00000030 E8(3E000000)                        call hasRepeated
    36 00000035 83C408                              add esp, 4 * 2
    37                                              
    38 00000038 41                                  inc ecx
    39 00000039 EBCA                                jmp .mainloop
    40                                          
    41                                          exitprogram:
    42 0000003B 6A00                                push 0
    43 0000003D FF15[00000000]                      call [exit]
